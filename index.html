<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Prometric Pass Prediction</title>

<style>
body { font-family: Arial; background:#f4f6f8; padding:20px }
.container { max-width:900px; margin:auto; background:#fff; padding:25px }
.hidden { display:none }
.option { border:1px solid #ccc; padding:12px; margin:10px 0; cursor:pointer }
.option.selected { background:#dde6ff }
.correct { border-left:6px solid green; background:#e9f8ee }
.wrong { border-left:6px solid red; background:#fdeaea }
button { padding:10px 16px; margin-top:15px }
</style>
</head>

<body>
<div class="container">

<!-- START -->
<div id="startScreen">
  <h2>SCFHS Prometric Pass Prediction</h2>
  Name:<br><input id="studentName"><br><br>
  ID:<br><input id="studentID"><br><br>
  <button id="startBtn">Start</button>
</div>

<!-- EXAM -->
<div id="examScreen" class="hidden">
  <h3 id="progress"></h3>
  <p id="questionText"></p>
  <div id="options"></div>
  <button id="submitBtn">Submit</button>
  <div id="rationaleBox" class="hidden"></div>
  <button id="nextBtn" class="hidden">Next</button>
</div>

<!-- RESULT -->
<div id="resultScreen" class="hidden">
  <h2>Result</h2>
  <p id="finalInfo"></p>
  <p id="decision"></p>
</div>

</div>

<script>
/* -------- DOM BINDING (THIS WAS MISSING) -------- */
const nameInput = document.getElementById("studentName");
const idInput   = document.getElementById("studentID");
const startBtn  = document.getElementById("startBtn");

/* -------- DATA -------- */
const questions = [{
  q: "A 68-year-old patient with pneumonia becomes restless. BP 88/54, HR 124, RR 30, SpO₂ 89%. Priority action?",
  options: [
    { text:"Notify physician", tag:"STR" },
    { text:"Elevate HOB and apply oxygen", tag:"SCFHS" },
    { text:"Obtain ABGs", tag:"NCLEX" },
    { text:"Prepare for intubation", tag:"SAFE_DELAY" }
  ],
  correctTag:"SCFHS",
  rationale:{
    correct:"Immediate oxygenation addresses life-threatening hypoxia before escalation.",
    distractors:{
      STR:"Escalation without stabilization is inappropriate.",
      NCLEX:"Diagnostics delay intervention.",
      SAFE_DELAY:"Advanced airway prep comes after basic stabilization."
    }
  }
}];

/* -------- ENGINE -------- */
let current = 0;
let selected = null;
let score = { SCFHS:0, NCLEX:0, STR:0, SAFE_DELAY:0 };

function shuffle(a){ return a.sort(()=>Math.random()-0.5); }

startBtn.onclick = () => {
  if (!nameInput.value || !idInput.value) {
    alert("Enter Name and ID");
    return;
  }
  shuffle(questions);
  questions.forEach(q=>shuffle(q.options));
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("examScreen").classList.remove("hidden");
  loadQuestion();
};

function loadQuestion(){
  selected=null;
  document.getElementById("rationaleBox").classList.add("hidden");
  document.getElementById("nextBtn").classList.add("hidden");
  const q = questions[current];
  document.getElementById("progress").innerText=`Question ${current+1}`;
  document.getElementById("questionText").innerText=q.q;
  const o=document.getElementById("options"); o.innerHTML="";
  q.options.forEach((opt,i)=>{
    const d=document.createElement("div");
    d.className="option";
    d.innerText=opt.text;
    d.onclick=()=>{ document.querySelectorAll(".option").forEach(x=>x.classList.remove("selected")); d.classList.add("selected"); selected=i; };
    o.appendChild(d);
  });
}

document.getElementById("submitBtn").onclick = () => {
  if (selected===null) return alert("Select option");
  const q=questions[current];
  const chosen=q.options[selected];
  const correct = chosen.tag===q.correctTag;
  correct ? score.SCFHS++ : score[chosen.tag]++;
  const r=document.getElementById("rationaleBox");
  r.classList.remove("hidden");
  let html = correct?"<b>Correct</b><br><br>":"<b>Incorrect</b><br><br>";
  q.options.forEach(opt=>{
    html+=`<p><b>${opt.text}</b><br>${opt.tag===q.correctTag?q.rationale.correct:q.rationale.distractors[opt.tag]}</p>`;
  });
  r.innerHTML=html;
  document.querySelectorAll(".option").forEach((d,i)=>{
    if(q.options[i].tag===q.correctTag) d.classList.add("correct");
    else if(i===selected) d.classList.add("wrong");
    d.onclick=null;
  });
  document.getElementById("nextBtn").classList.remove("hidden");
};

document.getElementById("nextBtn").onclick = () => {
  document.getElementById("examScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");
  document.getElementById("finalInfo").innerHTML=`${nameInput.value} | ${idInput.value}`;
  document.getElementById("decision").innerHTML=
    score.SCFHS>=score.NCLEX && score.SCFHS>=score.STR
    ? "<b>GO — SCFHS Readiness Indicated</b>"
    : "<b>NO-GO — Remediation Required</b>";
};
</script>
</body>
</html>
