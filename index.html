<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Prometric Pass Prediction</title>

<style>
body { font-family: Arial; background:#f4f6f8; padding:20px }
.container { max-width:900px; margin:auto; background:#fff; padding:25px }
.hidden { display:none }
.option { border:1px solid #ccc; padding:12px; margin:10px 0; cursor:pointer }
.option.selected { background:#dde6ff }
.correct { border-left:6px solid green; background:#e9f8ee }
.wrong { border-left:6px solid red; background:#fdeaea }
button { padding:10px 16px; margin-top:15px }
</style>
</head>

<body>
<div class="container">

<!-- START -->
<div id="startScreen">
  <h2>SCFHS Prometric Pass Prediction</h2>
  Name:<br><input id="studentName"><br><br>
  ID:<br><input id="studentID"><br><br>
  <button id="startBtn">Start</button>
</div>

<!-- EXAM -->
<div id="examScreen" class="hidden">
  <h3 id="progress"></h3>
  <p id="questionText"></p>
  <div id="options"></div>
  <button id="submitBtn">Submit</button>
  <div id="rationaleBox" class="hidden"></div>
  <button id="nextBtn" class="hidden">Next</button>
</div>

<!-- RESULT -->
<div id="resultScreen" class="hidden">
  <h2>Result</h2>
  <p id="finalInfo"></p>
  <p id="decision"></p>
</div>

</div>

<script>
/* -------- DOM BINDING (THIS WAS MISSING) -------- */
const nameInput = document.getElementById("studentName");
const idInput   = document.getElementById("studentID");
const startBtn  = document.getElementById("startBtn");

/* -------- DATA -------- */
const questions = [{
  q: "A 68-year-old patient with pneumonia becomes restless. BP 88/54, HR 124, RR 30, SpO₂ 89%. Priority action?",
  options: [
    { text:"Notify physician", tag:"STR" },
    { text:"Elevate HOB and apply oxygen", tag:"SCFHS" },
    { text:"Obtain ABGs", tag:"NCLEX" },
    { text:"Prepare for intubation", tag:"SAFE_DELAY" }
  ],
  correctTag:"SCFHS",
  rationale:{
    correct:"Immediate oxygenation addresses life-threatening hypoxia before escalation.",
    distractors:{
      STR:"Escalation without stabilization is inappropriate.",
      NCLEX:"Diagnostics delay intervention.",
      SAFE_DELAY:"Advanced airway prep comes after basic stabilization."
    }
  }
 },
{
  q: "A 72-year-old patient with COPD becomes increasingly drowsy. ABG shows pH 7.28, PaCO₂ 62 mmHg, PaO₂ 58 mmHg. SpO₂ 88% on 4 L nasal cannula. What is the nurse’s PRIORITY action?",
  options: [
    { text: "Increase oxygen flow to 6 L/min", tag: "SAFE_DELAY" },
    { text: "Prepare the patient for noninvasive ventilation (BiPAP)", tag: "SCFHS" },
    { text: "Notify the physician of worsening ABGs", tag: "STR" },
    { text: "Encourage deep breathing and coughing", tag: "NCLEX" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct:
      "The patient demonstrates acute respiratory acidosis with carbon dioxide retention. Noninvasive ventilation improves alveolar ventilation and reduces PaCO₂, addressing the underlying cause of deterioration.",
    distractors: {
      SAFE_DELAY:
        "Increasing oxygen alone may worsen CO₂ retention in COPD patients.",
      STR:
        "Provider notification is appropriate but should not delay ventilatory support.",
      NCLEX:
        "Breathing exercises are insufficient for acute ventilatory failure."
    }
  }
},
{
  q: "A postoperative client reports sudden chest pain and shortness of breath 24 hours after hip surgery. HR 118, RR 28, SpO₂ 90% on room air. What should the nurse do FIRST?",
  options: [
    { text: "Administer prescribed PRN analgesics", tag: "SAFE_DELAY" },
    { text: "Apply oxygen and raise the head of the bed", tag: "SCFHS" },
    { text: "Request a STAT chest X-ray", tag: "NCLEX" },
    { text: "Notify the surgeon immediately", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct:
      "The presentation suggests possible pulmonary embolism. Immediate oxygenation and positioning support gas exchange while further evaluation is arranged.",
    distractors: {
      SAFE_DELAY:
        "Treating pain alone delays management of a potentially fatal condition.",
      NCLEX:
        "Diagnostic testing should not precede stabilization.",
      STR:
        "Escalation is appropriate but only after initiating supportive care."
    }
  }
},
{
  q: "A patient with diabetes becomes confused and diaphoretic. Capillary glucose reads 42 mg/dL. What is the nurse’s PRIORITY action?",
  options: [
    { text: "Administer IV dextrose per protocol", tag: "SCFHS" },
    { text: "Recheck blood glucose to confirm accuracy", tag: "NCLEX" },
    { text: "Notify the healthcare provider", tag: "STR" },
    { text: "Document findings and monitor closely", tag: "SAFE_DELAY" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct:
      "The patient is experiencing symptomatic hypoglycemia. Immediate administration of glucose corrects neuroglycopenia and prevents seizure or loss of consciousness.",
    distractors: {
      NCLEX:
        "Repeating testing delays urgent treatment.",
      STR:
        "Provider notification should not delay life-saving intervention.",
      SAFE_DELAY:
        "Observation without treatment places the patient at significant risk."
    }
  }
},
{
  q: "A client receiving a blood transfusion develops fever, chills, and flank pain 15 minutes after initiation. What is the nurse’s FIRST action?",
  options: [
    { text: "Stop the transfusion immediately", tag: "SCFHS" },
    { text: "Administer antipyretics as ordered", tag: "NCLEX" },
    { text: "Notify the blood bank", tag: "STR" },
    { text: "Slow the transfusion rate", tag: "SAFE_DELAY" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct:
      "These findings suggest an acute hemolytic transfusion reaction. Stopping the transfusion immediately prevents further exposure and reduces the risk of renal failure and shock.",
    distractors: {
      NCLEX:
        "Medications do not address the cause of the reaction.",
      STR:
        "Notification is required but only after stopping the transfusion.",
      SAFE_DELAY:
        "Slowing the infusion allows continued antigen exposure."
    }
  }
},
{
  q: "A patient with a history of stroke suddenly develops unilateral weakness and slurred speech. Time of onset is unknown. What should the nurse do FIRST?",
  options: [
    { text: "Perform a rapid neurological assessment", tag: "SCFHS" },
    { text: "Prepare the patient for CT imaging", tag: "NCLEX" },
    { text: "Notify the stroke response team", tag: "STR" },
    { text: "Check blood glucose level", tag: "SAFE_DELAY" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct:
      "A focused neurological assessment establishes baseline deficits and guides urgency of further interventions while maintaining rapid workflow.",
    distractors: {
      NCLEX:
        "Imaging is required but should follow immediate bedside assessment.",
      STR:
        "Escalation is appropriate after initial evaluation.",
      SAFE_DELAY:
        "Glucose assessment is important but should not delay stroke evaluation."
    }
  }
}
}];

/* -------- ENGINE -------- */
let current = 0;
let selected = null;
let score = { SCFHS:0, NCLEX:0, STR:0, SAFE_DELAY:0 };

function shuffle(a){ return a.sort(()=>Math.random()-0.5); }

startBtn.onclick = () => {
  if (!nameInput.value || !idInput.value) {
    alert("Enter Name and ID");
    return;
  }
  shuffle(questions);
  questions.forEach(q=>shuffle(q.options));
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("examScreen").classList.remove("hidden");
  loadQuestion();
};

function loadQuestion(){
  selected=null;
  document.getElementById("rationaleBox").classList.add("hidden");
  document.getElementById("nextBtn").classList.add("hidden");
  const q = questions[current];
  document.getElementById("progress").innerText=`Question ${current+1}`;
  document.getElementById("questionText").innerText=q.q;
  const o=document.getElementById("options"); o.innerHTML="";
  q.options.forEach((opt,i)=>{
    const d=document.createElement("div");
    d.className="option";
    d.innerText=opt.text;
    d.onclick=()=>{ document.querySelectorAll(".option").forEach(x=>x.classList.remove("selected")); d.classList.add("selected"); selected=i; };
    o.appendChild(d);
  });
}

document.getElementById("submitBtn").onclick = () => {
  if (selected===null) return alert("Select option");
  const q=questions[current];
  const chosen=q.options[selected];
  const correct = chosen.tag===q.correctTag;
  correct ? score.SCFHS++ : score[chosen.tag]++;
  const r=document.getElementById("rationaleBox");
  r.classList.remove("hidden");
  let html = correct?"<b>Correct</b><br><br>":"<b>Incorrect</b><br><br>";
  q.options.forEach(opt=>{
    html+=`<p><b>${opt.text}</b><br>${opt.tag===q.correctTag?q.rationale.correct:q.rationale.distractors[opt.tag]}</p>`;
  });
  r.innerHTML=html;
  document.querySelectorAll(".option").forEach((d,i)=>{
    if(q.options[i].tag===q.correctTag) d.classList.add("correct");
    else if(i===selected) d.classList.add("wrong");
    d.onclick=null;
  });
  document.getElementById("nextBtn").classList.remove("hidden");
};

document.getElementById("nextBtn").onclick = () => {
  document.getElementById("examScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");
  document.getElementById("finalInfo").innerHTML=`${nameInput.value} | ${idInput.value}`;
  document.getElementById("decision").innerHTML=
    score.SCFHS>=score.NCLEX && score.SCFHS>=score.STR
    ? "<b>GO — SCFHS Readiness Indicated</b>"
    : "<b>NO-GO — Remediation Required</b>";
};
</script>
</body>
</html>
